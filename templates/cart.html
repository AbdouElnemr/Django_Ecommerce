{% extends 'basepage.html' %}
{% load static %}

{% block title %}
Cart
{% endblock %}

{% block content %}
</header>
<!-- </section> -->
<link rel="stylesheet" href="{% static 'css/cart.css' %}" >
<div class="container-fluid product_bg py-2">
    <div id="products-container" class="container">
        <section id="main-section" class="ml-auto">


<div class="container mb-4">
    <div class="row">
        <div class="col-12">
            <div class="table-responsive">
                <table class="table table-striped">
                    <thead>
                        <tr>
                            <th scope="col"> </th>
                            <th scope="col">Product</th>
                            <th scope="col">Available</th>

                            <th scope="col" class="text-center">Quantity</th>
                            <th></th>
                            <th scope="col" class="text-right">Price</th>
                            <th> </th>
                        </tr>
                    </thead>
                    <tbody>
                        {%for cart_item in cart.cart_items.all%}

                        <tr>
                            <td><img src="{{ cart_item.myproduct.image.url }} " width="50" height="50" /> </td>
                            <td>{{cart_item.myproduct.name}}</td>
                            <td>In stock</td>
                            <form action="{%url 'cart:update_number' cart_item.id %}" method="POST">
                                {%csrf_token%}
                            <td>
                                <input class="form-control" width="50" type="number" name="number" value={{cart_item.number}} />

                            </td>

                            <td>
                                <button type="submit" class="btn btn-sm btn-danger"><i class="fa fa-save"></i> </button>

                            </td>
                        </form>
                            <td class="text-right">{{cart_item.total}} $</td>
                            <form action="{% url 'cart:remove_from_cart' cart_item.id%}" method="POST">
                                {%csrf_token%}
                            <td class="text-right"><button type="submit" class="btn btn-sm btn-danger"><i class="fa fa-trash"></i> </button> </td>
                            </form>
                        </tr>
                        {%endfor%}

                        <tr>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td class="text-right"></td>
                        </tr>
                        <tr>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td><strong>Total</strong></td>
                            <td class="text-right"><strong>{{cart.total}} $</strong></td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
        <div class="col mb-2">
            <div class="row">
                <div class="col-sm-12  col-md-6">

                    <a type="submit" href="{%url 'home' %}" class="btn btn-block btn-light">Continue Shopping</a>

                </div>
                <div class="col-sm-12 col-md-6 ">
<!--                                     <form action="{% url 'charge' %}" method="post">-->
<!--                            {% csrf_token %}-->
<!--                    <button class="btn btn-lg btn-block btn-success text-uppercase" type="submit">Checkout</button>-->
<!--                                     </form>-->
                  <form action="{% url 'charge' %}" method="post">
                      {% csrf_token %}
                      <script src="https://checkout.stripe.com/checkout.js" class="stripe-button"
                              data-key="{{ key }}"
                              data-description="A Django Charge"
                              data-amount="{{cart.total}}"
                              data-locale="auto"></script>
                    </form>

                </div>
            </div>
        </div>s
    </div>
</div>


        </section>
    </div>
</div>
<!-- products section -->
{% endblock %}